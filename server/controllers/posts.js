import { Posts } from "../model/Posts.js";
import { Op } from "sequelize";




/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////// GET POSTS CONTROLLER /////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
export const getPosts = async (req, res)=>{
    console.log("LOADING PICTURES!!!!!")
    // Find Posts without search query
    if (req.query.label === '') {
        const data = await Posts.findAll({
            order: [['createdAt', 'DESC']]
        });
        return res.status(200).json(data);
    }
    // Find Posts with search query
    const data = await Posts.findAll({ 
        where: { label: { [Op.like]: `%${req.query.label}%` }},
        order: [['createdAt', 'DESC']]
    });
    return res.status(200).json(data);
};
//----------------------------------------------------------------------------------------------------------------------/





/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////// ADD POSTS CONTROLLER /////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
export const addPosts = async (req, res)=>{
    console.log("UPLOADING NEW PICTURE!!!!!")
    await Posts.create(req.body);
    return res.send("Post has been added");
   
};
//----------------------------------------------------------------------------------------------------------------------/







/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////// DELETE POSTS CONTROLLER /////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
export const deletePost = async (req, res)=>{
    console.log("DELETING PICTURE!!!!!")
    await Posts.destroy({ where: { id: req.params.id}});
    return res.json("Post has been deleted!!");

 };
 //----------------------------------------------------------------------------------------------------------------------/